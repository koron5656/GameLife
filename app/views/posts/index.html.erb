<h1>投稿一覧</h1>

<%= search_form_for @q, url: posts_path, method: :get do |f| %>
  <%= f.search_field :title_or_posted_text_cont, placeholder: 'キーワード検索' %>
  <%= f.submit '検索' %>
<% end %>

<%= link_to "all", posts_path, class: "badge badge-scondary" %>
<% @tags.each do |tag| %>
  <%= link_to tag.name, posts_path(tag_name: tag.name) %>
<% end %>

<% @posts.each do |post| %>
  <div>
    <%#= image_tag post.get_image %>
    <%= link_to post_path(post.id) do %>
      <%= image_tag post.get_image %>
    <% end %>

    <p>投稿ユーザー画像：<%= image_tag post.user.get_profile_image(100,100) %></p>
    <p>ユーザー名：<%= post.user.name %></p>
    <p>タイトル：<%= post.title %></p>
    <p>説明：<%= post.posted_text %></p>
    <p>タグ：</p>
    <% if post.tag_counts_on(:tags).any? %>
      <% post.tag_counts_on(:tags).each do |tag| %>
        <%= link_to tag.name, posts_path(tag_name: tag.name) %>
        <%#= link_to "#{tag.name}(#{tag.taggings_count})", tag_path(tag.name) %>
      <% end %>
    <% else %>
      <p>登録されているタグはありません</p>
    <% end %>
    <p><%= link_to "#{post.comments.count} コメント", post_path(post.id) %></p>
  </div>
<% end %>